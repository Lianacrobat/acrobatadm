---
import LayoutSEO from "../layouts/LayoutSEO.astro";
import HeroSection from "../components/ui/HeroSection.astro";

// Tipos TypeScript para el formulario
interface TestimonioForm {
	nombre: string;
	instagram?: string;
	cargo: string;
	empresa: string;
	pais: string;
	fechaCompra: string;
	testimonio: string;
}

interface FormElements extends HTMLFormControlsCollection {
	nombre: HTMLInputElement;
	instagram: HTMLInputElement;
	cargo: HTMLInputElement;
	empresa: HTMLInputElement;
	pais: HTMLSelectElement;
	fechaCompra: HTMLInputElement;
	testimonio: HTMLTextAreaElement;
}

interface TestimonioFormElement extends HTMLFormElement {
	readonly elements: FormElements;
}
---

<LayoutSEO
	title="Testimonios - Comparte tu Experiencia | Acrobata Demente"
	description="Comparte tu experiencia con nuestros productos y servicios acrobáticos. Tu testimonio ayuda a otros atletas a tomar mejores decisiones."
	keywords="testimonios, reseñas, experiencias, feedback, clientes, productos acrobáticos, servicios"
	author="Acrobata Demente"
	robots="index, follow"
	canonical="https://acrobatademente.com/testimonios"
	lang="es"
	og={{
		title: "Testimonios - Comparte tu Experiencia",
		description:
			"Ayúdanos a mejorar compartiendo tu experiencia con nuestros productos y servicios acrobáticos.",
		image: "https://acrobatademente.com/assets/cover/testimonios.jpg",
		url: "https://acrobatademente.com/testimonios",
		type: "website",
		site_name: "Acrobata Demente",
	}}
	twitter={{
		card: "summary_large_image",
		title: "Testimonios - Comparte tu Experiencia",
		description:
			"Tu opinión es importante. Comparte tu experiencia con nuestros productos acrobáticos.",
		image: "https://acrobatademente.com/assets/cover/testimonios.jpg",
	}}
>
	<!-- Hero Section -->
	<section>
		<HeroSection
			colorHero="bg-gradient-to-r from-emerald-400 via-teal-500 to-cyan-500"
			heroTitle="Comparte tu Experiencia"
			heroParagraph="Tu testimonio ayuda a otras personas a tomar mejores decisiones"
			heroImage="comunidad"
		/>
	</section>

	<!-- Formulario de Testimonios -->
	<section class="py-6 pt-4">
		<div class="max-w-3xl mx-auto">
			<div>
				<!-- Formulario -->
				<form
					id="testimonioForm"
					class="space-y-4"
				>
					<!-- Información Personal -->
					<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
						<!-- Nombre -->
						<div class="space-y-1.5">
							<label
								for="nombre"
								class="block text-sm font-medium text-[var(--text-color)]"
							>
								Nombre Completo *
							</label>
							<input
								type="text"
								id="nombre"
								name="nombre"
								required
								class="w-full px-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] placeholder-[var(--text-color-soft)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200"
								placeholder="María González"
							/>
						</div>

						<!-- Usuario Instagram -->
						<div class="space-y-1.5">
							<label
								for="instagram"
								class="block text-sm font-medium text-[var(--text-color)]"
							>
								Instagram (opcional)
							</label>
							<div class="relative">
								<span
									class="absolute left-3 top-1/2 transform -translate-y-1/2 text-[var(--text-color-soft)] text-sm"
									>@</span
								>
								<input
									type="text"
									id="instagram"
									name="instagram"
									class="w-full pl-7 pr-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] placeholder-[var(--text-color-soft)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200"
									placeholder="usuario"
								/>
							</div>
						</div>
					</div>

					<!-- Información Profesional -->
					<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
						<!-- Cargo -->
						<div class="space-y-1.5">
							<label
								for="cargo"
								class="block text-sm font-medium text-[var(--text-color)]"
							>
								Cargo/Posición *
							</label>
							<input
								type="text"
								id="cargo"
								name="cargo"
								required
								class="w-full px-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] placeholder-[var(--text-color-soft)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200"
								placeholder="Entrenador de Gimnasia"
							/>
						</div>

						<!-- Club/Empresa -->
						<div class="space-y-1.5">
							<label
								for="empresa"
								class="block text-sm font-medium text-[var(--text-color)]"
							>
								Club o Empresa *
							</label>
							<input
								type="text"
								id="empresa"
								name="empresa"
								required
								class="w-full px-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] placeholder-[var(--text-color-soft)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200"
								placeholder="Club Gimnástico Elite"
							/>
						</div>
					</div>

					<!-- País y Fecha -->
					<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
						<!-- País -->
						<div class="space-y-1.5">
							<label
								for="pais"
								class="block text-sm font-medium text-[var(--text-color)]"
							>
								País *
							</label>
							<select
								id="pais"
								name="pais"
								required
								class="w-full px-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200"
							>
								<option value="">Selecciona tu país</option>
								<option value="Afganistán">Afganistán</option>
								<option value="Albania">Albania</option>
								<option value="Alemania">Alemania</option>
								<option value="Andorra">Andorra</option>
								<option value="Angola">Angola</option>
								<option value="Antigua y Barbuda">Antigua y Barbuda</option>
								<option value="Arabia Saudita">Arabia Saudita</option>
								<option value="Argelia">Argelia</option>
								<option value="Argentina">Argentina</option>
								<option value="Armenia">Armenia</option>
								<option value="Australia">Australia</option>
								<option value="Austria">Austria</option>
								<option value="Azerbaiyán">Azerbaiyán</option>
								<option value="Bahamas">Bahamas</option>
								<option value="Bangladés">Bangladés</option>
								<option value="Barbados">Barbados</option>
								<option value="Baréin">Baréin</option>
								<option value="Bélgica">Bélgica</option>
								<option value="Belice">Belice</option>
								<option value="Benín">Benín</option>
								<option value="Bielorrusia">Bielorrusia</option>
								<option value="Birmania">Birmania</option>
								<option value="Bolivia">Bolivia</option>
								<option value="Bosnia y Herzegovina"
									>Bosnia y Herzegovina</option
								>
								<option value="Botsuana">Botsuana</option>
								<option value="Brasil">Brasil</option>
								<option value="Brunéi">Brunéi</option>
								<option value="Bulgaria">Bulgaria</option>
								<option value="Burkina Faso">Burkina Faso</option>
								<option value="Burundi">Burundi</option>
								<option value="Bután">Bután</option>
								<option value="Cabo Verde">Cabo Verde</option>
								<option value="Camboya">Camboya</option>
								<option value="Camerún">Camerún</option>
								<option value="Canadá">Canadá</option>
								<option value="Catar">Catar</option>
								<option value="Chad">Chad</option>
								<option value="Chile">Chile</option>
								<option value="China">China</option>
								<option value="Chipre">Chipre</option>
								<option value="Ciudad del Vaticano">Ciudad del Vaticano</option>
								<option value="Colombia">Colombia</option>
								<option value="Comoras">Comoras</option>
								<option value="Corea del Norte">Corea del Norte</option>
								<option value="Corea del Sur">Corea del Sur</option>
								<option value="Costa de Marfil">Costa de Marfil</option>
								<option value="Costa Rica">Costa Rica</option>
								<option value="Croacia">Croacia</option>
								<option value="Cuba">Cuba</option>
								<option value="Dinamarca">Dinamarca</option>
								<option value="Dominica">Dominica</option>
								<option value="Ecuador">Ecuador</option>
								<option value="Egipto">Egipto</option>
								<option value="El Salvador">El Salvador</option>
								<option value="Emiratos Árabes Unidos"
									>Emiratos Árabes Unidos</option
								>
								<option value="Eritrea">Eritrea</option>
								<option value="Eslovaquia">Eslovaquia</option>
								<option value="Eslovenia">Eslovenia</option>
								<option value="España">España</option>
								<option value="Estados Unidos">Estados Unidos</option>
								<option value="Estonia">Estonia</option>
								<option value="Esuatini">Esuatini</option>
								<option value="Etiopía">Etiopía</option>
								<option value="Filipinas">Filipinas</option>
								<option value="Finlandia">Finlandia</option>
								<option value="Fiyi">Fiyi</option>
								<option value="Francia">Francia</option>
								<option value="Gabón">Gabón</option>
								<option value="Gambia">Gambia</option>
								<option value="Georgia">Georgia</option>
								<option value="Ghana">Ghana</option>
								<option value="Granada">Granada</option>
								<option value="Grecia">Grecia</option>
								<option value="Guatemala">Guatemala</option>
								<option value="Guyana">Guyana</option>
								<option value="Guinea">Guinea</option>
								<option value="Guinea-Bisáu">Guinea-Bisáu</option>
								<option value="Guinea Ecuatorial">Guinea Ecuatorial</option>
								<option value="Haití">Haití</option>
								<option value="Honduras">Honduras</option>
								<option value="Hungría">Hungría</option>
								<option value="India">India</option>
								<option value="Indonesia">Indonesia</option>
								<option value="Irak">Irak</option>
								<option value="Irán">Irán</option>
								<option value="Irlanda">Irlanda</option>
								<option value="Islandia">Islandia</option>
								<option value="Islas Marshall">Islas Marshall</option>
								<option value="Islas Salomón">Islas Salomón</option>
								<option value="Israel">Israel</option>
								<option value="Italia">Italia</option>
								<option value="Jamaica">Jamaica</option>
								<option value="Japón">Japón</option>
								<option value="Jordania">Jordania</option>
								<option value="Kazajistán">Kazajistán</option>
								<option value="Kenia">Kenia</option>
								<option value="Kirguistán">Kirguistán</option>
								<option value="Kiribati">Kiribati</option>
								<option value="Kuwait">Kuwait</option>
								<option value="Laos">Laos</option>
								<option value="Lesoto">Lesoto</option>
								<option value="Letonia">Letonia</option>
								<option value="Líbano">Líbano</option>
								<option value="Liberia">Liberia</option>
								<option value="Libia">Libia</option>
								<option value="Liechtenstein">Liechtenstein</option>
								<option value="Lituania">Lituania</option>
								<option value="Luxemburgo">Luxemburgo</option>
								<option value="Macedonia del Norte">Macedonia del Norte</option>
								<option value="Madagascar">Madagascar</option>
								<option value="Malasia">Malasia</option>
								<option value="Malaui">Malaui</option>
								<option value="Maldivas">Maldivas</option>
								<option value="Malí">Malí</option>
								<option value="Malta">Malta</option>
								<option value="Marruecos">Marruecos</option>
								<option value="Mauricio">Mauricio</option>
								<option value="Mauritania">Mauritania</option>
								<option value="México">México</option>
								<option value="Micronesia">Micronesia</option>
								<option value="Moldavia">Moldavia</option>
								<option value="Mónaco">Mónaco</option>
								<option value="Mongolia">Mongolia</option>
								<option value="Montenegro">Montenegro</option>
								<option value="Mozambique">Mozambique</option>
								<option value="Namibia">Namibia</option>
								<option value="Nauru">Nauru</option>
								<option value="Nepal">Nepal</option>
								<option value="Nicaragua">Nicaragua</option>
								<option value="Níger">Níger</option>
								<option value="Nigeria">Nigeria</option>
								<option value="Noruega">Noruega</option>
								<option value="Nueva Zelanda">Nueva Zelanda</option>
								<option value="Omán">Omán</option>
								<option value="Países Bajos">Países Bajos</option>
								<option value="Pakistán">Pakistán</option>
								<option value="Palaos">Palaos</option>
								<option value="Palestina">Palestina</option>
								<option value="Panamá">Panamá</option>
								<option value="Papúa Nueva Guinea">Papúa Nueva Guinea</option>
								<option value="Paraguay">Paraguay</option>
								<option value="Perú">Perú</option>
								<option value="Polonia">Polonia</option>
								<option value="Portugal">Portugal</option>
								<option value="Reino Unido">Reino Unido</option>
								<option value="República Centroafricana"
									>República Centroafricana</option
								>
								<option value="República Checa">República Checa</option>
								<option value="República del Congo">República del Congo</option>
								<option value="República Democrática del Congo"
									>República Democrática del Congo</option
								>
								<option value="República Dominicana"
									>República Dominicana</option
								>
								<option value="Ruanda">Ruanda</option>
								<option value="Rumanía">Rumanía</option>
								<option value="Rusia">Rusia</option>
								<option value="Samoa">Samoa</option>
								<option value="San Cristóbal y Nieves"
									>San Cristóbal y Nieves</option
								>
								<option value="San Marino">San Marino</option>
								<option value="San Vicente y las Granadinas"
									>San Vicente y las Granadinas</option
								>
								<option value="Santa Lucía">Santa Lucía</option>
								<option value="Santa Sede">Santa Sede</option>
								<option value="Santo Tomé y Príncipe"
									>Santo Tomé y Príncipe</option
								>
								<option value="Senegal">Senegal</option>
								<option value="Serbia">Serbia</option>
								<option value="Seychelles">Seychelles</option>
								<option value="Sierra Leona">Sierra Leona</option>
								<option value="Singapur">Singapur</option>
								<option value="Siria">Siria</option>
								<option value="Somalia">Somalia</option>
								<option value="Sri Lanka">Sri Lanka</option>
								<option value="Sudáfrica">Sudáfrica</option>
								<option value="Sudán">Sudán</option>
								<option value="Sudán del Sur">Sudán del Sur</option>
								<option value="Suecia">Suecia</option>
								<option value="Suiza">Suiza</option>
								<option value="Surinam">Surinam</option>
								<option value="Tailandia">Tailandia</option>
								<option value="Tanzania">Tanzania</option>
								<option value="Tayikistán">Tayikistán</option>
								<option value="Timor Oriental">Timor Oriental</option>
								<option value="Togo">Togo</option>
								<option value="Tonga">Tonga</option>
								<option value="Trinidad y Tobago">Trinidad y Tobago</option>
								<option value="Túnez">Túnez</option>
								<option value="Turkmenistán">Turkmenistán</option>
								<option value="Turquía">Turquía</option>
								<option value="Tuvalu">Tuvalu</option>
								<option value="Ucrania">Ucrania</option>
								<option value="Uganda">Uganda</option>
								<option value="Uruguay">Uruguay</option>
								<option value="Uzbekistán">Uzbekistán</option>
								<option value="Vanuatu">Vanuatu</option>
								<option value="Venezuela">Venezuela</option>
								<option value="Vietnam">Vietnam</option>
								<option value="Yemen">Yemen</option>
								<option value="Yibuti">Yibuti</option>
								<option value="Zambia">Zambia</option>
								<option value="Zimbabue">Zimbabue</option>
								<option value="Otro">Otro</option>
							</select>
						</div>

						<!-- Fecha de Compra -->
						<div class="space-y-1.5">
							<label
								for="fechaCompra"
								class="block text-sm font-medium text-[var(--text-color)]"
							>
								Fecha de Compra *
							</label>
							<input
								type="date"
								id="fechaCompra"
								name="fechaCompra"
								required
								class="w-full px-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200"
							/>
						</div>
					</div>

					<!-- Testimonio -->
					<div class="space-y-1.5">
						<label
							for="testimonio"
							class="block text-sm font-medium text-[var(--text-color)]"
						>
							Testimonio *
						</label>
						<div
							class="flex justify-between items-center"
							id="testimonioInfo"
						>
							<p class="text-xs text-[var(--text-color-soft)]">
								Mínimo 50 caracteres
							</p>
							<!-- El contador se insertará aquí dinámicamente -->
						</div>
						<textarea
							id="testimonio"
							name="testimonio"
							required
							rows="4"
							class="w-full px-3 py-2.5 bg-[var(--bg-color)] border border-[var(--accent-color-soft)]/30 rounded-lg text-[var(--text-color)] placeholder-[var(--text-color-soft)] focus:border-[var(--accent-color)] focus:ring-1 focus:ring-[var(--accent-color)]/20 transition-colors duration-200 resize-vertical"
							placeholder="Comparte tu experiencia con nuestros productos. ¿Cómo te han ayudado en tu entrenamiento?"
						></textarea>
					</div>

					<!-- Botón de Envío -->
					<div class="flex justify-center pt-4">
						<button
							type="button"
							id="enviarWhatsApp"
							class="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2 w-full sm:w-auto min-w-[200px]"
						>
							<svg
								class="w-5 h-5"
								fill="currentColor"
								viewBox="0 0 24 24"
							>
								<path
									d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"
								></path>
							</svg>
							Enviar por WhatsApp
						</button>
					</div>

					<!-- Nota informativa -->
					<div
						class="bg-[var(--accent-color)]/10 border border-[var(--accent-color)]/20 rounded-lg p-3 mt-4"
					>
						<p class="text-[var(--text-color-soft)] text-xs text-center">
							Tu testimonio será enviado por WhatsApp y revisado antes de ser
							publicado
						</p>
					</div>
				</form>
			</div>
		</div>
	</section>

	<!-- Script para manejar el envío -->
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			// Elementos del DOM con tipos TypeScript
			const form = document.getElementById("testimonioForm");
			const whatsappBtn = document.getElementById("enviarWhatsApp");
			const testimonioTextarea = document.getElementById("testimonio");

			// Función para validar el formulario
			function validarFormulario(): boolean {
				const nombreEl = document.getElementById("nombre") as HTMLInputElement;
				const cargoEl = document.getElementById("cargo") as HTMLInputElement;
				const empresaEl = document.getElementById(
					"empresa"
				) as HTMLInputElement;
				const paisEl = document.getElementById("pais") as HTMLSelectElement;
				const fechaCompraEl = document.getElementById(
					"fechaCompra"
				) as HTMLInputElement;
				const testimonioEl = document.getElementById(
					"testimonio"
				) as HTMLTextAreaElement;

				if (
					!nombreEl ||
					!cargoEl ||
					!empresaEl ||
					!paisEl ||
					!fechaCompraEl ||
					!testimonioEl
				) {
					alert(
						"Error: No se pudieron encontrar todos los elementos del formulario."
					);
					return false;
				}

				const nombre = nombreEl.value.trim();
				const cargo = cargoEl.value.trim();
				const empresa = empresaEl.value.trim();
				const pais = paisEl.value;
				const fechaCompra = fechaCompraEl.value;
				const testimonio = testimonioEl.value.trim();

				if (
					!nombre ||
					!cargo ||
					!empresa ||
					!pais ||
					!fechaCompra ||
					!testimonio
				) {
					alert("Por favor, completa todos los campos obligatorios.");
					return false;
				}

				if (testimonio.length < 50) {
					alert("El testimonio debe tener al menos 50 caracteres.");
					return false;
				}

				return true;
			}

			// Función para generar el mensaje sin emojis
			function generarMensaje(): string {
				const nombreEl = document.getElementById("nombre") as HTMLInputElement;
				const instagramEl = document.getElementById(
					"instagram"
				) as HTMLInputElement;
				const cargoEl = document.getElementById("cargo") as HTMLInputElement;
				const empresaEl = document.getElementById(
					"empresa"
				) as HTMLInputElement;
				const paisEl = document.getElementById("pais") as HTMLSelectElement;
				const fechaCompraEl = document.getElementById(
					"fechaCompra"
				) as HTMLInputElement;
				const testimonioEl = document.getElementById(
					"testimonio"
				) as HTMLTextAreaElement;

				if (
					!nombreEl ||
					!instagramEl ||
					!cargoEl ||
					!empresaEl ||
					!paisEl ||
					!fechaCompraEl ||
					!testimonioEl
				) {
					return "Error: No se pudieron encontrar todos los elementos del formulario.";
				}

				const nombre = nombreEl.value.trim();
				const instagram = instagramEl.value.trim();
				const cargo = cargoEl.value.trim();
				const empresa = empresaEl.value.trim();
				const pais = paisEl.value;
				const fechaCompra = fechaCompraEl.value;
				const testimonio = testimonioEl.value.trim();

				let mensaje = `NUEVO TESTIMONIO - ACROBATA DEMENTE%0A%0A`;
				mensaje += `INFORMACION PERSONAL:%0A`;
				mensaje += `Nombre: ${nombre}%0A`;
				if (instagram) {
					mensaje += `Instagram: @${instagram}%0A`;
				}
				mensaje += `%0AINFORMACION PROFESIONAL:%0A`;
				mensaje += `Cargo: ${cargo}%0A`;
				mensaje += `Empresa/Club: ${empresa}%0A`;
				mensaje += `Pais: ${pais}%0A`;
				mensaje += `Fecha de compra: ${fechaCompra}%0A`;
				mensaje += `%0ATESTIMONIO:%0A`;
				mensaje += `"${testimonio}"%0A%0A`;
				mensaje += `Enviado desde: acrobatademente.com/testimonios`;

				return mensaje;
			}

			// Event listener para el botón de WhatsApp
			if (whatsappBtn && form) {
				whatsappBtn.addEventListener("click", function () {
					if (!validarFormulario()) return;

					// Cambiar estado del botón
					(whatsappBtn as HTMLButtonElement).disabled = true;
					whatsappBtn.innerHTML = `
						<svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
						</svg>
						Enviando...
					`;

					const mensaje = generarMensaje();
					const numeroWhatsApp = "8619981641420";
					const url = `https://wa.me/${numeroWhatsApp}?text=${mensaje}`;

					// Delay para mejor UX
					setTimeout(() => {
						window.open(url, "_blank");
						alert(
							"Testimonio enviado. Se abrirá WhatsApp para completar el envío."
						);
						(form as HTMLFormElement).reset();
						actualizarContador();

						// Restaurar botón
						(whatsappBtn as HTMLButtonElement).disabled = false;
						whatsappBtn.innerHTML = `
							<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
								<path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"></path>
							</svg>
							Enviar por WhatsApp
						`;
					}, 1000);
				});
			}

			// Contador de caracteres simplificado
			function actualizarContador() {
				// Función vacía para compatibilidad
			}
			// Contador de caracteres para el testimonio
			if (testimonioTextarea) {
				const testimonioInfo = document.getElementById("testimonioInfo");
				if (testimonioInfo) {
					const contadorDiv = document.createElement("div");
					contadorDiv.className = "text-xs text-[var(--text-color-soft)]";
					contadorDiv.id = "contadorCaracteres";
					testimonioInfo.appendChild(contadorDiv);

					testimonioTextarea.addEventListener("input", function () {
						const textarea = this as HTMLTextAreaElement;
						const longitud = textarea.value.length;
						const contador = document.getElementById("contadorCaracteres");

						if (contador) {
							contador.textContent = `${longitud} caracteres`;

							if (longitud < 50) {
								contador.className = "text-xs text-red-400";
							} else {
								contador.className = "text-xs text-emerald-400";
							}
						}
					});
				}
			}
		});
	</script>
</LayoutSEO>

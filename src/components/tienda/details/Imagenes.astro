---
import type { Product } from "../../../data/products";
import FavoriteButton from "../ui/FavoriteButton.astro";

export interface Props {
	product: Product;
	mainImage: string | ImageMetadata;
	placeholder: string;
}

const { product, mainImage, placeholder } = Astro.props;
---

<div class="w-full flex flex-col gap-4 bg-[var(--cajas)] p-4 rounded-xl">
	<div class="flex items-center gap-3">
		<div
			class="w-10 h-10 bg-[var(--accent-color-soft)]/10 rounded-lg flex items-center justify-center"
		>
			<svg
				xmlns="http://www.w3.org/2000/svg"
				width="24"
				height="24"
				viewBox="0 0 24 24"
				fill="none"
				stroke="currentColor"
				stroke-width="2"
				stroke-linecap="round"
				stroke-linejoin="round"
				class="text-[var(--text-color-soft)]"
				><path
					stroke="none"
					d="M0 0h24v24H0z"
					fill="none"
				></path><path d="M15 6l.01 0"></path><path
					d="M3 3m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z"
				></path><path d="M3 13l4 -4a3 5 0 0 1 3 0l4 4"></path><path
					d="M13 12l2 -2a3 5 0 0 1 3 0l3 3"></path><path d="M8 21l.01 0"
				></path><path d="M12 21l.01 0"></path><path d="M16 21l.01 0"
				></path></svg
			>
		</div>
		<div>
			<h3 class="text-lg font-semibold text-[var(--text-color)]">Imagenes</h3>
			<p class="text-xs text-[var(--text-color-soft)]">Fotos del producto</p>
		</div>
	</div>

	<div
		class="aspect-square w-full rounded-lg overflow-hidden relative bg-[var(--card)] flex items-center justify-center"
	>
		<img
			src={typeof mainImage === "string"
				? mainImage
				: mainImage?.src || placeholder}
			alt={product.name}
			class="w-full h-full object-cover"
			data-main-image
		/>
		<div class="absolute top-4 right-4">
			<FavoriteButton
				productId={product.id}
				productName={product.name}
			/>
		</div>
	</div>
	{
		product.images.length > 1 && (
			<div class="flex gap-4 justify-center mt-4">
				{product.images.slice(0, 3).map((image, idx) => (
					<button
						type="button"
						class={`aspect-square w-16 h-16 rounded-lg overflow-hidden border-2 transition-all duration-200 mb-1 ${
							idx === 0
								? "border-blue-500 shadow-lg"
								: "border-gray-200 hover:border-blue-300"
						}`}
						data-image-thumbnail
						aria-label={`Miniatura ${idx + 1}`}
						onclick={`selectProductImage(${idx})`}
					>
						<img
							src={
								typeof image === "string" ? image : image?.src || placeholder
							}
							alt={`${product.name} miniatura ${idx + 1}`}
							class="w-full h-full object-cover"
						/>
					</button>
				))}
			</div>
		)
	}
</div>

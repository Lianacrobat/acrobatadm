---

---

<div
	id="floating-container"
	class="pointer-events-none absolute inset-0 z-10 flex items-center justify-center overflow-hidden blur-[15px] grayscale-[90%]"
>
</div>
<script>
	let animationTimeouts: ReturnType<typeof setTimeout>[] = [];
	let animationActive = false;

	function clearAnimation() {
		animationTimeouts.forEach(clearTimeout);
		animationTimeouts = [];
		const container = document.getElementById("floating-container");
		if (container) container.innerHTML = "";
		animationActive = false;
	}

	function initCoverTiendaAnimation() {
		clearAnimation();
		const products = [
			{ src: `${import.meta.env.BASE_URL}assets/springFloor.png`, alt: "Spring Floor" },
			{ src: `${import.meta.env.BASE_URL}assets/xpe.png`, alt: "XPE" },
			{ src: `${import.meta.env.BASE_URL}assets/arnes.png`, alt: "Arnes" },
			{ src: `${import.meta.env.BASE_URL}assets/podium.png`, alt: "Podium" },
			{ src: `${import.meta.env.BASE_URL}assets/springTrack.png`, alt: "Spring Track" },
			{ src: `${import.meta.env.BASE_URL}assets/franjas.png`, alt: "Franjas" },
			{ src: `${import.meta.env.BASE_URL}assets/trampolin.png`, alt: "Trampolin" },
		];

		const container = document.getElementById("floating-container");
		if (!container) return;

		let currentImageIndex = 0;

		function showNextImage() {
			if (!container) return;
			container.innerHTML = "";

			const img = document.createElement("img");
			const product = products[currentImageIndex];
			img.src = product.src;
			img.alt = product.alt;
			img.classList.add("floating-product-img");
			img.style.position = "absolute";
			img.style.opacity = "0";
			img.style.pointerEvents = "none";
			img.style.transition = "opacity 2s ease-in-out, transform 3s ease-in-out";
			img.style.left = "50%";
			img.style.top = "50%";
			img.style.transform = "translate(-50%, -50%) scale(1)";

			// Tama√±o responsivo mejorado
			const isMobile = window.innerWidth <= 768;
			const isTablet = window.innerWidth <= 1024;
			if (isMobile) {
				img.style.maxWidth = "85vw";
				img.style.maxHeight = "65vh";
			} else if (isTablet) {
				img.style.maxWidth = "60vw";
				img.style.maxHeight = "50vh";
			} else {
				img.style.maxWidth = "40vw";
				img.style.maxHeight = "40vh";
			}
			img.style.width = "auto";
			img.style.height = "auto";
			img.style.objectFit = "contain";
			img.style.filter = "blur(0.3px) grayscale(90%)";
			img.style.zIndex = "1";

			container.appendChild(img);

			animationTimeouts.push(
				setTimeout(() => {
					img.style.opacity = "0.4";
					img.style.transform = "translate(-50%, -50%) scale(1.3)";
				}, 200)
			);

			animationTimeouts.push(
				setTimeout(() => {
					img.style.transform = "translate(-50%, -50%) scale(1.3)";
				}, 2000)
			);

			animationTimeouts.push(
				setTimeout(() => {
					img.style.opacity = "0";
					img.style.transform = "translate(-50%, -50%) scale(1.6)";
				}, 3500)
			);

			animationTimeouts.push(
				setTimeout(() => {
					container.innerHTML = "";
					currentImageIndex = (currentImageIndex + 1) % products.length;
					showNextImage();
				}, 5500)
			);
		}

		if (!animationActive) {
			animationActive = true;
			showNextImage();
		}
	}

	function handleResize() {
		initCoverTiendaAnimation();
	}

	document.addEventListener("DOMContentLoaded", initCoverTiendaAnimation);
	document.addEventListener("astro:after-swap", initCoverTiendaAnimation);
	window.addEventListener("resize", handleResize);
</script>

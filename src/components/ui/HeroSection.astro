---
import { imgRutas } from "../../data/productosImgRutas";
import type { ImageMetadata } from 'astro';

interface Props {
	/** Clases de gradiente para el fondo del hero */
	colorHero: string;
	/** Título principal del hero */
	heroTitle: string;
	/** Descripción o subtítulo del hero */
	heroParagraph: string;
	/** Clave de la imagen del hero desde imgRutas.hero */
	heroImage: keyof typeof imgRutas.hero;
	/** Texto alternativo para la imagen de fondo (accesibilidad) */
	altText?: string;
	/** Nivel de encabezado (h1, h2, etc.) */
	headingLevel?: 'h1' | 'h2' | 'h3';
	/** Clase CSS adicional para personalización */
	className?: string;
}

const { 
	colorHero,
	heroTitle,
	heroParagraph,
	heroImage,
	altText = heroTitle,
	headingLevel = 'h1',
	className = ''
} = Astro.props;

// Obtener la imagen con manejo de errores
const heroImageData = imgRutas.hero[heroImage];
const imageUrl = heroImageData?.src || imgRutas.placeholder?.src || '';

// Generar ID único para accesibilidad
const heroId = `hero-${Math.random().toString(36).substr(2, 9)}`;
const HeadingTag = headingLevel;
---

<!-- Hero Section Optimizado -->
<section 
	id={heroId}
	class={`relative overflow-visible rounded-b-xl ${className}`}
	role="banner"
	aria-labelledby={`${heroId}-title`}
	aria-describedby={`${heroId}-description`}
>
	<!-- Contenedor principal con gradiente -->
	<div class={`${colorHero} h-32 sm:h-36 md:h-40 flex items-center justify-center relative`} >
		<!-- Imagen de fondo optimizada -->
		{imageUrl && (
			<div
				class="absolute inset-0 opacity-10 bg-cover bg-center bg-no-repeat transition-opacity duration-300"
				style={`background-image: url(${imageUrl})`}
				aria-hidden="true"
				role="img"
				aria-label={altText}
			>
				<!-- Overlay para mejorar legibilidad -->
				<div class="absolute inset-0  "></div>
			</div>
		)}
		
		<!-- Contenido del hero -->
		<div class="relative w-full px-4 sm:px-6 md:px-8 text-center">
			<!-- Título principal -->
			<HeadingTag
				id={`${heroId}-title`}
				class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold tracking-tight mb-2 md:mb-4 text-white drop-shadow-lg"
			>
				{heroTitle}
			</HeadingTag>
			
			<!-- Descripción -->
			<p 
				id={`${heroId}-description`}
				class="text-sm sm:text-base md:text-lg font-medium text-white/95 max-w-2xl mx-auto leading-relaxed drop-shadow-md"
			>
				{heroParagraph}
			</p>
		</div>
	</div>
	
	<!-- Indicador visual sutil -->
	<div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 w-12 h-1 bg-white/20 rounded-full" aria-hidden="true"></div>
</section>

<!-- Preload de imagen crítica para mejor rendimiento -->
{imageUrl && (
	<link rel="preload" as="image" href={imageUrl} />
)}

<style>
	/* Optimizaciones de rendimiento */
	[role="banner"] {
		will-change: transform;
		contain: layout style paint;
	}
	
	/* Mejora de accesibilidad para usuarios con preferencias de movimiento reducido */
	@media (prefers-reduced-motion: reduce) {
		[role="banner"] * {
			transition: none !important;
			animation: none !important;
		}
	}
	
	/* Optimización para pantallas de alta densidad */
	@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
		[role="banner"] [style*="background-image"] {
			background-size: cover;
			image-rendering: -webkit-optimize-contrast;
			image-rendering: crisp-edges;
		}
	}
</style>
